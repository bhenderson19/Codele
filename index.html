<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3-Digit Guessing Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding-bottom: 200px; /* Added padding to ensure scrolling past the keypad */
            overflow-y: scroll; /* Enable vertical scrolling */
        }

        .guess-row {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 10px 0;
        }

        .guess-label {
            width: 100px;
            text-align: right;
            margin-right: 10px;
            font-weight: bold;
        }

        input[type="number"] {
            padding: 10px;
            font-size: 16px;
            width: 50px;
            text-align: center;
            margin: 0 5px;
            pointer-events: none;
        }

        input[type="number"]:disabled {
            background-color: #e0e0e0;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            margin-top: 20px;
        }

        #feedback, #score {
            margin-top: 20px;
            font-weight: bold;
        }

        .feedback {
            margin-left: 20px;
            font-size: 16px;
            font-weight: bold;
        }

        .keypad {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #f0f0f0;
            padding: 20px 0;
            display: flex;
            justify-content: center;
            z-index: 10; /* Ensure keypad stays on top */
        }

        .keypad-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-gap: 10px;
            max-width: 300px;
        }

        .keypad-grid button {
            width: 60px;
            height: 60px;
            font-size: 24px;
        }

        .keypad-grid button:nth-child(10) {
            grid-column: 1;
        }

        .keypad-grid button:nth-child(12) {
            grid-column: 3;
        }

        .hidden {
            display: none;
        }

        .nav-link {
            margin-top: 20px;
            font-size: 18px;
        }

        #resetButton {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>3-Digit Guessing Game</h1>
    <div id="guesses">
        <!-- Guess rows will be generated here dynamically -->
    </div>
    <div id="feedback"></div>
    <div id="score">Score: 800</div>
    <button id="resetButton" onclick="resetGame()">Reset Game</button>

    <div class="keypad">
        <div class="keypad-grid">
            <button onclick="handleKeypadClick(1)">1</button>
            <button onclick="handleKeypadClick(2)">2</button>
            <button onclick="handleKeypadClick(3)">3</button>
            <button onclick="handleKeypadClick(4)">4</button>
            <button onclick="handleKeypadClick(5)">5</button>
            <button onclick="handleKeypadClick(6)">6</button>
            <button onclick="handleKeypadClick(7)">7</button>
            <button onclick="handleKeypadClick(8)">8</button>
            <button onclick="handleKeypadClick(9)">9</button>
            <button onclick="handleKeypadClick(0)">0</button>
            <button onclick="backspace()">&#9003;</button>
            <button id="submitButton" onclick="submitGuess()">&#10003;</button>
        </div>
    </div>

    <script>
        const numberOfRows = 8;
        let currentRow = 0;
        let currentInputIndex = 0;
        const maxScore = 800;
        const correctCode = generateRandomCode();
        let score = maxScore;

        function startGame() {
            currentRow = 0;
            currentInputIndex = 0;
            score = maxScore;
            document.getElementById('guesses').innerHTML = ''; // Clear previous guesses
            for (let i = 0; i < numberOfRows; i++) {
                createGuessRow(i);
            }
            showCurrentRow();
        }

        function generateRandomCode() {
            return Math.floor(Math.random() * 900) + 100; // Random 3-digit code
        }

        function createGuessRow(rowIndex) {
            const rowDiv = document.createElement('div');
            rowDiv.classList.add('guess-row', 'hidden');
            rowDiv.id = `row-${rowIndex}`;

            const label = document.createElement('span');
            label.classList.add('guess-label');
            label.textContent = `Guess ${rowIndex + 1}`;

            rowDiv.appendChild(label);

            for (let i = 0; i < 3; i++) {
                const input = document.createElement('input');
                input.type = 'number';
                input.id = `row-${rowIndex}-digit-${i}`;
                input.disabled = true;
                rowDiv.appendChild(input);
            }

            const feedbackSpan = document.createElement('span');
            feedbackSpan.classList.add('feedback');
            feedbackSpan.id = `feedback-${rowIndex}`;
            rowDiv.appendChild(feedbackSpan);

            document.getElementById('guesses').appendChild(rowDiv);
        }

        function showCurrentRow() {
            const row = document.getElementById(`row-${currentRow}`);
            row.classList.remove('hidden');
            row.querySelectorAll('input').forEach(input => input.disabled = false);

            scrollToCurrentRow(); // Ensure proper scrolling
        }

        function submitGuess() {
            const guess = getCurrentGuess();
            const feedback = getFeedback(guess);
            displayFeedback(feedback);
            currentRow++;

            if (currentRow < numberOfRows) {
                showCurrentRow();
            }

            if (guess === correctCode || currentRow === numberOfRows) {
                disableInput(); // Disable further input if game is over
            }

            updateScore(feedback);
        }

        function getCurrentGuess() {
            let guess = '';
            for (let i = 0; i < 3; i++) {
                guess += document.getElementById(`row-${currentRow}-digit-${i}`).value;
            }
            return parseInt(guess, 10);
        }

        function getFeedback(guess) {
            const correctDigits = correctCode.toString().split('');
            const guessDigits = guess.toString().split('');

            let correctInPlace = 0;
            let correctOutOfPlace = 0;

            guessDigits.forEach((digit, index) => {
                if (digit === correctDigits[index]) {
                    correctInPlace++;
                } else if (correctDigits.includes(digit)) {
                    correctOutOfPlace++;
                }
            });

            return { correctInPlace, correctOutOfPlace };
        }

        function displayFeedback(feedback) {
            const feedbackElement = document.getElementById(`feedback-${currentRow}`);
            feedbackElement.textContent = `Correct in place: ${feedback.correctInPlace}, Correct out of place: ${feedback.correctOutOfPlace}`;
        }

        function updateScore(feedback) {
            if (feedback.correctInPlace !== 3) {
                score -= 100;
                document.getElementById('score').textContent = `Score: ${score}`;
            }
        }

        function handleKeypadClick(digit) {
            if (currentInputIndex < 3) {
                const input = document.getElementById(`row-${currentRow}-digit-${currentInputIndex}`);
                input.value = digit;
                currentInputIndex += 1;
            }
        }

        function backspace() {
            if (currentInputIndex > 0) {
                currentInputIndex -= 1;
                const input = document.getElementById(`row-${currentRow}-digit-${currentInputIndex}`);
                input.value = '';
            }
        }

        function scrollToCurrentRow() {
            const currentRowElement = document.getElementById(`row-${currentRow}`);
            if (currentRowElement) {
                currentRowElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function disableRow(rowIndex) {
            const row = document.getElementById(`row-${rowIndex}`);
            row.querySelectorAll('input').forEach(input => input.disabled = true);
        }

        function disableInput() {
            for (let i = 0; i < numberOfRows; i++) {
                disableRow(i);
            }
            document.getElementById('submitButton').disabled = true;
        }

        function resetGame() {
            correctCode = generateRandomCode();
            startGame();
            document.getElementById('submitButton').disabled = false;
            window.scroll({ top: 0, behavior: 'smooth' });
        }

        // Keyboard event listener
        document.addEventListener('keydown', function(event) {
            if (event.key >= '0' && event.key <= '9') {
                handleKeypadClick(parseInt(event.key));
            } else if (event.key === 'Backspace') {
                backspace();
            } else if (event.key === 'Enter') {
                submitGuess();
            }
            event.preventDefault(); // Prevent any other default action
        });

        // Start the game initially
        startGame();
    </script>
</body>
</html>
